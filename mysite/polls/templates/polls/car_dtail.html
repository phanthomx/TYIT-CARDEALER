{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Combined Document</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <style>
        /* Add styles from both documents */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #007bff;
        }
        h2 {
            margin-top: 30px;
            color: #333;
        }
        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        header {
            background-color: #007bff;
            padding: 30px 0;

        }

        nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        nav ul li {
            display: inline;
            margin-right: 20px;
        }

        nav ul li:last-child {
            margin-right: 0;
        }

        nav a {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            font-size: 18px;
        }
        li {
            margin-bottom: 10px;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
        }

        /* Slideshow gallery styles */
        .mySlides,
        .mySlides1 {
            display: none;
        }
        .numbertext,
        .numbertext1 {
            color: #f2f2f2;
            font-size: 12px;
            padding: 8px 12px;
            position: absolute;
            top: 0;
          }
        .prev,
        .prev1,
        .next,
        .next1 {
            cursor: pointer;
            position: absolute;
            top: 40%;
            width: auto;
            padding: 16px;
            margin-top: -50px;
            color: white;
            font-weight: bold;
            font-size: 20px;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
        }
        .next,
        .next1 {
            right: 0;
            border-radius: 3px 0 0 3px;
        }
        .prev:hover,
        .prev1:hover,
        .next:hover,
        .next1:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
        .row:after,
        .row1:after {
            content: "";
            display: table;
            clear: both;
        }
        .column,
        .column1 {
            float: left;
            width: 16.66%;
        }
        .demo,
        .demo1 {
            opacity: 0.6;
        }
        .active,
        .demo:hover,
        .active1,
        .demo1:hover {
            opacity: 1;
        }
        
          .slideshow2 {
              position: relative;
          }
      
          .slideshow2 img {
              display: block;
              max-width: 100%;
          }
      
          .color-name {
              position: absolute;
              bottom: 10px; /* Adjust as needed */
              left: 10px; /* Adjust as needed */
              background-color: rgba(255, 255, 255, 0.7); /* Adjust background color and opacity */
              padding: 5px;
              font-size: 14px;
              color :red;
          }
          * {box-sizing: border-box;}

          .Dons {
            position: relative;
            width: 100%;

          }
          
          #colored {
            display: block;
            width: 100%;
            height: auto;
          }
          
          .layer {
            position: absolute; 
            bottom: 0; 
            background: rgb(0, 0, 0);
            background: rgba(0, 0, 0, 0.5); /* Black see-through */
            color: #f1f1f1; 
            width: 100%;
            transition: .5s ease;
            opacity:1;
            color: white;
            font-size: 20px;
            padding: 20px;
            text-align: center;
          }
          
          .Dons:hover .layer {
            opacity: 1;}
            
          select#selected_color,#selected_fuel,#selected_varient {
              border: 1px solid #ccc;
              padding: 8px 10px;
              font-size: 16px;
              border-radius: 4px;
              background-color: #b0f6ff;
              /* Customize appearance here */
            }

          #colcar{
            color:white;
            background-color:lightgrey;
          }
          /* Table */
          #news_table {
            font-family: Arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        input[type="radio"] {
            margin-right: 5px;
        }
        .car-artwork {
          display: flex;
          flex-wrap: wrap;
          justify-content: space-between;
          margin-bottom: 20px;
      }
      .car-item {
          background-color: #f9f9f9;
          border: 1px solid #ddd;
          border-radius: 5px;
          padding: 20px;
          width: calc(33.33% - 20px); /* Adjust the width as needed */
          margin-bottom: 20px;
      }
      .car-type {
          font-size: 20px;
          color: #333;
          margin-bottom: 10px;
      }
      .car-desc {
          font-size: 16px;
          color: #666;
          margin-bottom: 10px;
      }
      .car-owning {
          font-size: 16px;
          color: #888;
      }
      .checkout-btn {
        background-color: #4CAF50; /* Green */
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 8px;
        transition: background-color 0.3s ease;
      }
      
      .checkout-btn:hover {
        background-color: #45a049; /* Darker green on hover */
      }
      

    </style>
</head>
<body>
    <header>
        <nav>
          <ul>
            <li><a href="{% url 'home' %}">Logout</a></li>
            <li><a href="{% url 'buy' %}">BUY</a></li>
            <li><a href="{% url 'service' %}">SERVICE</a></li>
            <li><a href="{% url 'events' %}">EVENTS</a></li>
          </ul>
        </nav>
      </header>
      <h1>MODEL</h1>
      <div style="overflow: hidden;">
        <div style="float: left; width: 33.33%; background-color: lightgrey;">
            <h2>Name</h2>
            <h2>{{ Model_info.name }}</h2>
        </div>
        <div style="float: left; width: 33.33%; background-color: lightgrey;">
            <h2>Starting price</h2>
            <h2>₹{{ Model_info.min_price }}</h2>
        </div>
        <div style="float: left; width: 33.33%; background-color: lightgrey;">
            <h2>Mileage</h2>
            <h2>{{ Model_info.mileage }}</h2>
        </div>
    </div>


    <h1> EXTERIOR</h1>
    <div class="slideshow-container">
      {% for car_media_ext in CarMedia_Ext %}
        <div class="mySlides">
          <div class="numbertext">{{ forloop.counter }} / {{ CarMedia_Ext.count }}</div>
          <img src="{{ car_media_ext.Exterior.url }}" style="width:100%">
        </div>
      {% endfor %}
    
      <a class="prev" onclick="plusSlides(-1)">❮</a>
      <a class="next" onclick="plusSlides(1)">❯</a>
    
      <div class="caption-container">
        <p id="caption"></p>
      </div>
    
      <div class="row">
        {% for i in CarMedia_Ext %}
          <div class="column">
            <img class="demo cursor" src="{{ i.Exterior.url }}" style="width:100%" onclick="currentSlide({{ forloop.counter }})">
          </div>
        {% endfor %}
      </div>
    </div>
    

    <h1>INTERIOR</h1>
    <div class="slideshow1">
      {% for media in CarMedia_Int %}
      <img src="{{ media.Interior.url }}" alt="Car Interior">
      {% endfor %}

    </div>

      </div>
      <h1>AVAILABLE COLORS</h1>
      <div class="slideshow2">
        {% for color in colors %}
          <div>
            <div class="Dons">
              <img id="colored" src="{{ color.colorpic.url }}" alt="{{ color.colorname }}" class="image">
              <div class="layer">{{ color.colorname }}</div>
            </div>
          </div>
        {% endfor %}
      </div>
      
<div id="colcar">
  <h2><label for="selected_color">Choose a car color:</label></h2>
<select id="selected_color">
  {% for color in colors %}
  <option id="selcar" value="{{ color.colorname }}">{{ color.colorname }}</option>
 
  {% endfor %}
</select>
</div>
<h1>TECHNOLOGY</h1>
<div class="slideshow2">
  {% for tec in Tech %}
    <div>
      <div class="Dons">
        <img id="colored" src="{{ tec.Tech_pic.url }}" alt="{{ tec.Tech_name }}" class="image">
        <div class="layer">{{ tec.Tech_name }}-{{ tec.Tech_desc }}</div>
      </div>
    </div>
  {% endfor %}
</div>
     
    <h1>SELECT VARIENT</h1>

    <table id="news_table">
     {% for varient in varients %}
      <tr>
        <td id="row1_cell2">{{ varient.Varient_name }}</td>
        <td id="row1_cell3">{{ varient.Varient_desc }}</td>
        <td id="row1_cell4">+{{ varient.Var_price }}</td>
      </tr>
{% endfor %}

    </table>
    <select id="selected_varient">
      {% for varient in varients %}
      <option id="selcar" value="{{ varient.Varient_name }}|{{ varient.Var_price }}">{{ varient.Varient_name }}</option>      
      {% endfor %}
    </select>

    <table id="news_table">
      {% for f in fuel %}
      <tr>
        <td id="row1_cell2">{{ f.Fuel_type }}</td>
        <td id="row1_cell3">+{{ f.Fuel_price }}</td>
        {% endfor %}
      </tr>
     

    </table>
      <select id="selected_fuel">
        {% for f in fuel %}
        <option id="selcar" value="{{ f.Fuel_type }}|{{ f.Fuel_price}}">{{ f.Fuel_type  }}</option>

        {% endfor %}
      </select>

<div class="car-artwork">
  {% for i in info %}
    <div class="car-item">
      <h2 class="car-type">{{ i.car_type }}</h2>
      <p class="car-desc"><strong>Description:</strong> {{ i.car_desc }}</p>
      <p class="car-owning"><strong>Owning:</strong> {{ i.owning }}</p>
    </div>
  {% endfor %}

  <div class="car-item">
    {%for gen in genfo%}
    <h2 class="car-type">Max price: {{ gen.max_price }}</h2>
    <p class="car-desc"id="booking-cost"><strong>Booking Cost:</strong> {{ gen.booking_cost }}</p>
    <p class="car-owning"><strong>Approx Delivery Time:</strong> {{ gen.Delivery_time }}</p>
    <p class="car-owning"><strong>EMI:</strong> {{ gen.emi }}</p>
    {% endfor %}
  </div>
</div>

<div id="selected_values">
  <h2>Selected Values</h2>
  <p id="color_selected">Color: </p>
  <p id="variant_selected">Variant: </p>
  <p id="fuel_selected">Fuel Type: </p>
</div>
<div id="selected_values">
  <h2>Total Price</h2>
  <p id="total_price"></p>
</div>
<form id="carForm" method="post" action="{% url 'orderinfo' %}">
  {% csrf_token %}
  <!-- Hidden input fields to store selected values -->
  <input type="text" name="selected_color" id="selected_color_input">
  <input type="text" name="selected_varient" id="selected_varient_input">
  <input type="text" name="selected_fuel" id="selected_fuel_input">
  <input type="text" name="tot_price" id="tot_price_input">
  <input type="text" name="modelName" id="modelName" value="{{ Model_info.name }}">
  <input type="text" name="bookingAmount" id="bookingAmount_input" value="{{ booking_amount }}">

  <input type="submit"  value="Pay Now!">


</form>




<script>    
var csrfToken = "{{ csrf_token }}";
console.log(csrfToken)  
const selectedColor = document.getElementById('selected_color');
const selectedVariant = document.getElementById('selected_varient');
const selectedFuel = document.getElementById('selected_fuel');
const colorSelected = document.getElementById('color_selected');
const variantSelected = document.getElementById('variant_selected');
const fuelSelected = document.getElementById('fuel_selected');
const totalPriceElement = document.getElementById('total_price');
const basePrice = parseFloat('{{ Model_info.min_price }}');
const bookingAmount = parseFloat('{{ genfo.0.booking_cost }}');
document.getElementById("bookingAmount_input").value = bookingAmount;
console.log("-------");
console.log(bookingAmount)


// Add event listeners to the select elements to update the displayed values when a selection is made
selectedColor.addEventListener('change', function() {
  colorSelected.textContent = 'Color: ' + this.value;
});

selectedVariant.addEventListener('change', function() {
  const selectedOption = this.value.split('|');
  const VarientType = selectedOption[0];
  const VarientPrice = parseFloat(selectedOption[1]);
  variantSelected.textContent = 'Variant: ' + VarientType;
  console.log('Varient Type:', VarientType);
  console.log('Varient Price:', VarientPrice);

  updateTotalPrice();

});


selectedFuel.addEventListener('change', function() {
  const selectedOption = this.value.split('|');
  const fuelType = selectedOption[0];
  const fuelPrice = parseFloat(selectedOption[1]);
  fuelSelected.textContent = 'Fuel Type: ' + fuelType;
  console.log('Fuel Type:', fuelType);
  console.log('Fuel Price:', fuelPrice);

  updateTotalPrice();

});

function updateTotalPrice() {
  const selectedVariantOption = selectedVariant.value.split('|');
  const selectedFuelOption = selectedFuel.value.split('|');

  const variantPrice = parseFloat(selectedVariantOption[1]);
  const fuelPrice = parseFloat(selectedFuelOption[1]);

  const totalPrice = basePrice + variantPrice + fuelPrice;

  totalPriceElement.textContent = 'Total Price: ₹' + totalPrice.toFixed(2);
}
// Function to send data via AJAX
{% comment %} function sendDataViaAjax() {
  // Extracting selected options from the select elements
  const selectedColorValue = selectedColor.value;
  const selectedVariantValue = selectedVariant.value;
  const selectedFuelValue = selectedFuel.value;

  // Extracting variant type and fuel type from selected options
  const selectedVariantOption = selectedVariantValue.split('|');
  const selectedFuelOption = selectedFuelValue.split('|');

  const variantType = selectedVariantOption[0];
  const fuelType = selectedFuelOption[0];

  // Extracting booking amount from somewhere in your code
  const bookingAmount = parseFloat('{{ genfo.0.booking_cost }}');
  console.log("-------");
  console.log(bookingAmount)
  // Total price calculation
  const variantPrice = parseFloat(selectedVariantOption[1]);
  const fuelPrice = parseFloat(selectedFuelOption[1]);
  const totalPrice = basePrice + variantPrice + fuelPrice;

  // Model name extraction
  const modelName = '{{ Model_info.name }}';

  // AJAX request to send data to the server
  $.ajax({
    type: 'POST',
    url: '/orderinfo/', 
    headers: { "X-CSRFToken": csrfToken },// Replace with your server endpoint
    data: {
      totalPrice: totalPrice,
      fuelType: fuelType,
      colorVariant: selectedColorValue,
      variantType: variantType,
      modelName: modelName,
      bookingAmount: bookingAmount,
      
    },
    dataType: "json",
    success: function(response) {
      console.log(response)
      window.location.href = response.redirect_url;


    },
    error: function(xhr, status, error) {
      // Handle error if any
      console.error('Error sending data: ', error);
    }
  });
} {% endcomment %}

// Event listener for the Checkout Now button
{% comment %} document.getElementById('checkout').addEventListener('click', function() {
  // Call the function to send data via AJAX
  sendDataViaAjax();
}); {% endcomment %}


        $(document).ready(function(){
            $('.slideshow1').slick({
              autoplay: true, // Auto play slides
              autoplaySpeed: 2000, // Slide display duration in milliseconds
              dots: true, // Show dots navigation
              arrows: true // Show arrow navigation
            });
          });
          $(document).ready(function(){
            $('.slideshow2').slick({
              autoplay: true, // Auto play slides
              autoplaySpeed: 2000, // Slide display duration in milliseconds
              dots: true, // Show dots navigation
              arrows: true // Show arrow navigation
            });
          });


        let slideIndex = 1;
        showSlides(slideIndex);
    
        function plusSlides(n) {
            showSlides(slideIndex += n);
        }
    
        function currentSlide(n) {
            showSlides(slideIndex = n);
        }
    
        function showSlides(n) {
            let i;
            let slides = document.getElementsByClassName("mySlides");
            let dots = document.getElementsByClassName("demo");
            let captionText = document.getElementById("caption");
            if (n > slides.length) {slideIndex = 1}
            if (n < 1) {slideIndex = slides.length}
            for (i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }
            slides[slideIndex-1].style.display = "block";
            dots[slideIndex-1].className += " active";
            captionText.innerHTML = dots[slideIndex-1].alt;
        }

    

    </script>
    <script>
      // Function to update hidden input field with selected value
      function updateHiddenInput(inputId, selectedValue) {
          document.getElementById(inputId).value = selectedValue;
      }
  
      // Event listener for color dropdown
      document.getElementById("selected_color").addEventListener("change", function() {
          var selectedColor = this.value;
          updateHiddenInput("selected_color_input", selectedColor);
      });
  
      // Event listener for variant dropdown
      document.getElementById("selected_varient").addEventListener("change", function() {
          var selectedVariant = this.value;
          updateHiddenInput("selected_varient_input", selectedVariant.split("|")[0]); // Only extract variant name
          calculateTotal();
      });
  
      // Event listener for fuel dropdown
      document.getElementById("selected_fuel").addEventListener("change", function() {
          var selectedFuel = this.value;
          updateHiddenInput("selected_fuel_input", selectedFuel.split("|")[0]); // Only extract fuel type
          calculateTotal();
      });
  
      // Function to calculate total price
      function calculateTotal() {
          var variantPrice = parseFloat(document.getElementById("selected_varient").value.split("|")[1]);
          var fuelPrice = parseFloat(document.getElementById("selected_fuel").value.split("|")[1]);
          var totalPrice = basePrice + variantPrice + fuelPrice;
          document.getElementById("tot_price_input").value = totalPrice.toFixed(2);
      }
  
  </script>
  

    
</body>
</html> 
